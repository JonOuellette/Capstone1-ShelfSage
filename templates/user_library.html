{% extends "base.html" %}

{% block content %}
<h1>{{g.user.username}} Library</h1>
<ul>
    {% for book in books %}
    <li>
        <h3><a href="{{ url_for('book_details', volume_id=book.volume_id) }}">{{ book.title }}</a></h3>
            <p>Author(s): {{book.authors|safe}}</p>
        
        {% if book.image_links %}
                <img src="{{ book.image_links }}" alt="Book Cover">
        {% else %}
            <p>No image available</p>
        {% endif %}

        <form action="{{ url_for('delete_book_from_library', book_id=book.id) }}" method="POST">
            <input type="submit" value="Delete">
        </form>

    </li>
    {% endfor %}
</ul>
<!-- Display user's bookshelves -->
{% for bookshelf in bookshelves %}
    <div>
        <h2>{{ bookshelf.name }}</h2>
        <p>{{ bookshelf.description }}</p>
        <!-- List books in the bookshelf -->
        <ul>
            {% for book in bookshelf.books %}
                <li>{{ book.title }} - <a href="#" class="remove-book" data-book-id="{{ book.id }}">Remove</a></li>
            {% endfor %}
        </ul>
        <div class="bookshelf" data-bookshelf-id="{{ bookshelf.id }}">
            <input type="text" value="{{ bookshelf.name }}" class="bookshelf-name" readonly>
            <button class="rename-bookshelf">Rename</button>
            <button class="delete-bookshelf">Delete</button>
            <!-- Books and other bookshelf content here... -->
        </div>
    </div>
{% endfor %}

<!-- Display books not in a bookshelf -->
<ul>
    {% for book in books %}
        <!-- Check if the book is not in a bookshelf -->
        {% if book not in shelved_books %}
            <li>
                {{ book.title }}
                <!-- Dropdown to select bookshelf -->
                <select class="bookshelf-selector" data-book-id="{{ book.id }}">
                    <option value="">Add to bookshelf...</option>
                    {% for bookshelf in bookshelves %}
                        <option value="{{ bookshelf.id }}">{{ bookshelf.name }}</option>
                    {% endfor %}
                </select>
            </li>
        {% endif %}
    {% endfor %}
</ul>


{% endblock %}
